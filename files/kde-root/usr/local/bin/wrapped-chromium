#! /bin/bash

BIN=/usr/bin/chromium
DEFAULT_FLAGS="--disable-dev-shm-usage --disable-gpu --use-gl=swiftshader --password-store=basic"
EXTRA_FLAGS=(${CHROMIUM_FLAGS:-})

# Cleanup
if ! pgrep chromium > /dev/null;then
  rm -f $HOME/.config/chromium/Singleton*
fi

# Run normally on privved containers or modified un non priv
if grep -q 'Seccomp:.0' /proc/1/status; then
  ${BIN} ${DEFAULT_FLAGS} "${EXTRA_FLAGS[@]}" "$@"
else
  ${BIN} ${DEFAULT_FLAGS} --no-sandbox --test-type "${EXTRA_FLAGS[@]}" "$@"
fi
